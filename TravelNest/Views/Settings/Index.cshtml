<!DOCTYPE html>
@model Profil
@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager
@{
    var userId = UserManager.GetUserId(User);
}
<html>
<head>
    <link rel="stylesheet" href="~/css/Profil.css">
    <link rel="stylesheet" href="~/css/Settings.css">
    <link rel="stylesheet" href="~/css/comentarii.css">
    <link rel="stylesheet" href="~/css/replyComs.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <i id="menuBtn" class="fa-solid fa-bars"></i>
    <div class="sideMenu">
        <img id="logoMenu" src="~/images/logoMenu.png" />
        <div id="butonMeniu">
            <a asp-controller="Profil" asp-action="Index">
                <p>Profile</p>
            </a>
        </div>
        <div id="butonMeniu">
            <a asp-controller="Notifications" asp-action="Index">
                <p>Notifications</p>
                <span id="punctRosu" style="display:none;">0</span>
            </a>
        </div>
        <div id="butonMeniu">
            <p>For You</p>
        </div>
        <div id="butonMeniu" class="AddPost2">
            <p>New Post</p>
        </div>
        <div id="butonMeniu">
            <a asp-controller="TravelGroup" asp-action="Index">
                <p>New Travel Group</p>
            </a>
        </div>
        <div id="butonMeniu">
            <p>Search Destination</p>
        </div>
        <div id="butonMeniu">
            <p>Find Accommodation</p>
        </div>
        <div id="butonMeniu">
            <p>Travel Map</p>
        </div>
        <div class="butoaneJos">
                <div id="butonMeniu">
                     <a asp-controller="Settings" asp-action="Index">
                        <p id="paginaCurenta">Settings</p>
                     </a>
                </div>
                <div id="butonMeniu" class="logoutBtn">
                    <a asp-area="Identity" asp-page="/Account/Logout">
                        <p>Logout</p>
                    </a>
                </div>
        </div>
    </div>
    <div id="setariPage">
        <h2 id="titluSet">Settings</h2>
        <div id="setBtn">
            <button id="ProfilSet">Profile</button>
            <button id="ConfSet">Privacy</button>
            <button id="Arhive">Arhive</button>
        </div>
        <div id="paginaProfilSet">
            <form method="post" enctype="multipart/form-data" asp-controller="Settings" asp-action="EditProfil">
                <input type="hidden" asp-for="UserId" />
                <input type="hidden" asp-for="Id" />
                <input type="hidden" asp-for="User.FirstName" />
                <input type="hidden" asp-for="User.LastName" />
                <input type="hidden" asp-for="User.DateOfBirth" value="@Model.User.DateOfBirth.ToString("yyyy-MM-dd")" />
                <input type="hidden" asp-for="User.Email" />
                <div id="schimbaImagine">
                    <img id="previzualizare" src="@Model.ImagineProfil" />
                    <input name="ImagineProfil" type="file" id="ImagineProfil" accept="image/png, image/jpg, image/jpeg" />
                    <div id="pozeSet">
                        <label for="ImagineProfil" id="SelecteazaPoza">Select A Photo</label>
                        <input type="hidden" id="ResetImage" name="ResetImage" value="false" />
                        <label id="removeProfileImg">Delete Profile Photo</label>
                    </div>
                    <span asp-validation-for="ImagineProfil" class="text-danger"></span>
                </div>
                <br />
                <div id="inputUsername">
                    <label asp-for="User.UserName">Username</label>
                    <input asp-for="User.UserName" type="text" maxlength="50" />
                    <span asp-validation-for="User.UserName" class="text-danger"></span>
                </div>
      
                <br />
                <h5 id="bioh5">Bio</h5>
                <textarea asp-for="Bio" maxlength="255" value="@Model.Bio" placeholder="Bio"></textarea>
                <br />
                <button type="submit">Save Changes</button>
            </form>
            @section Scripts {
                <script src="~/js/settings.js"></script>
                <script src="~/js/butonSideMenu.js" asp-append-version="true"></script>
                <script src="~/js/popUpPostare.js" asp-append-version="true"></script>
                <script src="~/js/profil.js" asp-append-version="true"></script>
                <script src="~/js/replysComs.js" asp-append-version="true"></script> 
            }
        </div>
        <div id="sectiuneSetariPrivacy">
            <div id="SetNouaParola">
                <h3>Change Password</h3>
                <form id="formSchimbaParola">
                    <div class="inputParola">
                        <input id="parolaCurenta" name="parolaCurenta" type="password" placeholder="Current Password" required />
                    </div>
                    <div class="inputParola">
                        <input id="parolaNoua" name="parolaNoua" type="password" placeholder="New Password" required />
                    </div>
                    <div class="inputParola">
                        <input id="confirmareParola" type="password" placeholder="Confirm New Password" required />
                    </div>
                    <div id="mesajEroareParola" class="text-danger"></div>
                    <div id="mesajSuccesParola">
                        <i class="fa-solid fa-check-circle"></i> Password updated successfully!
                    </div>
                    <button type="submit" id="btnUpdateParola">Update Password</button>
                </form>
            </div>

            <div id="setariProfilePrivacy">
                <input type="hidden" id="hiddenProfilId" value="@Model.Id" />
                <div class="randButonActivare">
                    <span class="textBtn">Make Profile Private</span>
                    <label class="switch filled">
                        <input type="checkbox" name="isPrivate" @(Model.isPrivate ? "checked" : "")>
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="randButonActivare">
                    <span class="textBtn">Disable Auto-Tag Suggestions</span>
                    <label class="switch filled">
                        <input type="checkbox" name="noTags" @(Model.autoTag ? "checked" : "")>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="randButonActivare">
                    <span class="textBtn">Include Profile in Tagging Searches</span>
                    <label class="switch filled">
                        <input type="checkbox" name="manualTag" @(Model.manualTag ? "checked" : "")>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </div>
        <div id="sectiuneArhivaSetari">
            <div id="rezultatPostari">
                @foreach (var postare in Model.Posts.OrderByDescending(p => p.DataCr))
                {
                    if (postare.Arhivata == true)
                    {
                        var aDatLike = postare.Likes.Any(l => l.UserId == userId);
                        var primaImagine = postare.FisiereMedia
                            .Where(f => f.fisier == Tip.Image)
                            .FirstOrDefault();
                        var primulVideo = postare.FisiereMedia
                            .Where(f => f.fisier == Tip.Video)
                            .FirstOrDefault();

                        <div class="card-postare" onclick="deschidePostare('@postare.Id')" style="cursor: pointer;">
                            @if (primaImagine != null)
                            {
                                <img src="@primaImagine.Url" class="media-postare" />
                            }
                            else if (primulVideo != null)
                            {
                                <video class="media-postare" muted>
                                    <source src="@primulVideo.Url" type="video/mp4" />
                                </video>
                                <i class="fa-solid fa-play" style="position:absolute; top:10px; right:10px; color:white; text-shadow: 0 0 5px black;"></i>
                            }
                        </div>
                    }
                }
            </div>
        </div>
        <div id="fereastra-postare" class="modal-overlay" style="display: none;">
            <div class="modal-container">

                <span class="buton-inchidere" onclick="inchideFereastra()">&times;</span>

                <div class="zona-media">
                    <div class="media-wrapper" style="position: relative;">
                        <div id="continut-media"></div>

                        <div id="userTagsIcon" class="userTagsIcon" onclick="viewTags()" style="display: none;">
                            <i class="fa-solid fa-user-tag"></i>
                        </div>

                        <div id="listaTags" class="tags-popover" style="display: none;">
                        </div>
                    </div>

                    <div class="media-controls">
                        <button id="btn-inapoi" class="nav-btn" onclick="schimbaSlide(-1)">&#10094;</button>
                        <button id="btn-inainte" class="nav-btn" onclick="schimbaSlide(1)">&#10095;</button>
                    </div>
                </div>

                <div class="zona-detalii">
                    <div class="detalii-header">
                        <img id="header-poza-profil" src="" class="poza-rotunda">
                        <div class="text-header">
                            <span id="header-username" class="nume-bold"></span>
                            <span id="header-locatie" class="locatie-text"></span>
                        </div>
                        <div id="boxOptiuniPostari" style="margin-left: auto; position: relative; display: none;">
                            <i class="fas fa-ellipsis-h optiuni-postare-icon" onclick="afisMeniuOptiuniPostari()" style="cursor: pointer; padding: 5px;"></i>

                            <div id="MeniuOptiuniPostare" style="right: 0; top: 25px; width: 120px;">
                                <div id="OptiuniArhiveazaPost" class="ElementeDinMeniu" onclick="DezarhivarePostare()">
                                    <i class="fas fa-archive"></i> Unarchive
                                </div>
                                <div id="OptiuniStergePost" class="ElementeDinMeniu" onclick="StergerePostare()" style="color: #ed4956; border-top: 1px solid #efefef;">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="detalii-body">
                        <div class="rand-descriere">
                            <img id="body-poza-profil" src="" class="poza-rotunda mica">
                            <div class="continut-text">
                                <span id="body-username" class="nume-bold"></span>
                                <span id="descriere-text" class="text-normal"></span>
                            </div>
                        </div>
                        <div id="data-postarii" class="data-text"></div>
                        <div id="lista-comentarii"></div>
                    </div>

                    <div class="detalii-footer" style="display: none">

                        <div class="iconite-actiune" style="display: flex; align-items: center; gap: 20px; font-size: 1.5rem; margin-bottom: 10px;">

                            <div id="btn-like-modal" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <i class="fa-regular fa-heart" id="iconInima" style="line-height: 1;"></i>
                                <span id="text-like-count-modal" style="font-size: 1rem; font-weight: bold; line-height: 1;">0</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <i class="far fa-comment" id="iconComentariu"></i>
                                <span id="text-comm-count-modal" style="font-size: 1rem; font-weight: bold; line-height: 1;">0</span>
                            </div>

                        </div>
                        <div class="zona-input-comentariu">
                            <input id="input-comentariu-text" type="text" placeholder="Add a comment..." maxlength="255">
                            <button onclick="postCom()">Post</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="popupStergeCom" class="popUp" style="display: none;">
                <div class="popUpbox">
                    <h3 id="popUpTitlu">Delete this comment?</h3>
                    <p id="popUpMesaj">Are you sure you want to delete this comment? The action cannot be undone.</p>

                    <div class="butoanePopUp">
                        <button onclick="inchidePopUp()" id="btnAnularePopUp">Cancel</button>
                        <button onclick="StergeCom()" id="btnStergeComPopUp">Delete</button>
                    </div>
                </div>
            </div>
            <div id="popupStergeReply" class="popUp" style="display: none;">
                <div class="popUpbox">
                    <h3 id="popUpTitlu">Delete Reply?</h3>
                    <p id="popUpMesaj"> Are you sure you want to delete this reply?</p>
                    <div class="butoanePopUp">
                        <button id="btnAnularePopUp" onclick="inchidePopUpReply()">Cancel</button>
                        <button id="btnStergeComPopUp" onclick="ConfirmaStergereReply()">Delete</button>
                    </div>
                </div>
            </div>
            <div id="popupStergePostare" class="popUp" style="display: none;">
                <div class="popUpbox">
                    <h3 id="popUpTitlu">Delete Post?</h3>
                    <p id="popUpMesaj">Are you sure you want to delete this post? This action cannot be undone.</p>
                    <div class="butoanePopUp">
                        <button id="btnAnularePopUp" onclick="inchidePopUpPostare()">Cancel</button>
                        <button id="btnStergeComPopUp" onclick="ConfirmaStergerePostare()">Delete</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
